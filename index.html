<!DOCTYPE html>
<html>

<head>
    <!-- <script id="vertex-shader-lighting" type="x-shader/x-vertex">
        const vec4 lightPosition = vec4(0.0, 1.8, 1.3, 1.0);

        attribute vec4 vPosition; // vertex position in modelling coordinates
        attribute vec4 vNormal; // vertex normal in modelling coordinates

        uniform mat4 mModelView; // model transformation
        uniform mat4 mNormals; // model-view transformation for normals
        uniform mat4 mView; // view transformation (for points)
        uniform mat4 mViewNormals; // view transformation (for vectors)
        uniform mat4 mProjection; // projection matrix

        varying vec3 fNormal; // normal vector in camera space
        varying vec3 fLight; // Light vector in camera space
        varying vec3 fViewer; // View vector in camera space

        void main(){
            // compute position in camera frame
            vec3 posC = (mModelView * vPosition).xyz;
            
            // compute normal in camera frame
            fNormal = (mNormals * vNormal).xyz;

            // compute light vector in camera frame
            if(lightPosition.w == 0.0)
                fLight = normalize((mViewNormals * lightPosition).xyz);
            else
                fLight = normalize((mView*lightPosition).xyz - posC);

            // Compute the view vector
            // fViewer = -fPosition; // Perspective projection
            fViewer = vec3(0,0,1); // Parallel projection only

            // Compute vertex position in clip coordinates (as usual)
            gl_Position = mProjection * mModelView * vPosition;
        }

    </script> -->
    <script id="vertex-shader" type="x-shader/x-vertex">
        attribute vec4 vPosition;
        attribute vec4 vNormal;
        uniform mat4 mModelView;
        uniform mat4 mView;
        uniform mat4 mProjection;
        varying vec4 fNormal;

        void main(){
            gl_Position = mProjection * mModelView * vPosition;
            fNormal = vNormal;
        }
    </script>
    <!-- <script id="fragment-shader-lighting" type="x-shader/x-fragment">
        precision mediump float;

        varying vec3 fPosition;
        varying vec3 fNormal;

        const vec3 materialAmb = vec3(1.0, 0.0, 0.0);
        const vec3 materialDif = vec3(1.0, 0.0, 0.0);
        const vec3 materialSpe = vec3(1.0, 1.0, 1.0);
        const float shininess = 6.0;

        const vec3 lightAmb = vec3(0.2, 0.2, 0.2);
        const vec3 lightDif = vec3(0.7, 0.7, 0.7);
        const vec3 lightSpe = vec3(1.0, 1.0, 1.0);

        vec3 ambientColor = lightAmb * materialAmb;
        vec3 diffuseColor = lightDif * materialDif;
        vec3 specularColor = lightSpe * materialSpe;

        varying vec3 fLight;
        varying vec3 fViewer;

        void main() {
            vec3 L = normalize(fLight);
            vec3 V = normalize(fViewer);
            vec3 N = normalize(fNormal);
            vec3 H = normalize(L+V);

            float diffuseFactor = max( dot(L, N), 0.0);
            vec3 diffuse = diffuseFactor * diffuseColor;

            float specularFactor = pow( max( dot(N,H), 0.0), shininess );
            vec3 specular = specularFactor * specularColor;

            if ( dot(L,N) < 0.0 ) {
                specular = vec3(0.0, 0.0, 0.0);
            }

            gl_FragColor = vec4(ambientColor + diffuse + specular, 1.0);
            
            // gl_FragColor = abs(fNormal);
        }
    </script> -->
    <script id="fragment-shader" type="x-shader/x-fragment">
        precision mediump float;

        varying vec4 fNormal;

        void main() {
            gl_FragColor = abs(fNormal);
        }
    </script>
    <link rel="stylesheet" href="styles.css">
    <script type="text/javascript" src="../Common/webgl-utils.js"></script>
    <script type="text/javascript" src="../Common/initShaders.js"></script>
    <script type="text/javascript" src="../Common/MV.js"></script>
    <script type="text/javascript" src="../Common/cube.js"></script>
    <script type="text/javascript" src="../Common/sphere.js"></script>
    <script type="text/javascript" src="../Common/cylinder.js"></script>
    <script type="text/javascript" src="../Common/torus.js"></script>
    <script type="text/javascript" src="../Common/pyramid.js"></script>
    <script type="text/javascript" src="../Common/paraboloid.js"></script>
    <script type="text/javascript" src="constants.js"></script>
    <script type="text/javascript" src="app.js"></script>

</head>

<body>
    <div>
        <title>Objects</title>
        <canvas id="gl-canvas" width="800" height="500">
            Oops... your browser doesn't support the HTML5 canvas element"
        </canvas>

    </div>

    <button class="tablink" onclick="openPage('ortho-proj', this, 'blue')">Orthogonal</button>
    <button class="tablink" onclick="openPage('axon-proj', this, 'purple')" id="defaultOpen">Axonometric</button>
    <button class="tablink" onclick="openPage('persp-proj', this, 'darkcyan')">Perspective</button>
    <button class="tablink" onclick="openPage('lighting', this, 'deepskyblue')">Lighting</button>
    <button class="tablink" onclick="openPage('objects', this, 'pink')">Objects</button>

    <div id="ortho-proj" class="tabcontent">
        <h3>Orthogonal Projection</h3>
        <div>
            <input type="radio" id="ortho-alcado-princ" name="proj" value="PERSP_ALC_PRINC">
            <label>Alcado Principal</label></br>
            <input type="radio" id="ortho-plant" name="proj" value="PERSP_PLANT">
            <label>Plant</label></br>
            <input type="radio" id="ortho-alcado-lat" name="proj" value="PERSP_ALC_LAT">
            <label>Alcado Lateral</label>
        </div>
    </div>

    <div id="axon-proj" class="tabcontent">
        <h3>Axonometric Projection</h3>
        <div>
            γ: <input id="gamma" type="range" name="gamma" min="-180" max="180" step="0.01" disabled></input>
            θ: <input id="theta" type="range" name="theta" min="-180" max="180" step="0.01" disabled></input>
        </div></br>
        <div>
            <input type="radio" id="axon-iso" name="proj" value="ISO">
            <label>Isometry</label></br>
            <input type="radio" id="axon-dim" name="proj" value="DIM" checked="checked">
            <label>Dimetry (A=42º, B=7º)</label></br>
            <input type="radio" id="axon-tri" name="proj" value="TRI">
            <label>Trimetry (A=54º 16', B=23º16') </label></br>
            <input type="radio" id="axon-free" name="proj" value="FREE">
            <label>Free</label>
        </div>
    </div>

    <div id="persp-proj" class="tabcontent">
        <h3>Perspective Projection</h3>
        <input type="radio" id="persp" name="proj" value="PERSP">
        <label>Perspective (centered at (0,0,d))</label>
    </div>

    <div id="lighting" class="tabcontent">
        <h3>Lighting</h3>
        <input id="light-x" type="number" min="-1.0" max="1.0" step="0.1">
        <input id="light-y" type="number" min="-1.0" max="1.0" step="0.1">
        <input id="light-z" type="number" min="-1.0" max="1.0" step="0.1">
        <select id="light-direction">
            <option value="POINT">Point</option>
            <option value="DIRECTIONAL">Directional</option>
        </select>
        <label>Light Position</label>
        <br><br>
        <input id="shininess" type="range" min="0.0" step="1.0" default="6.0">
        <label>Shininess</label>
        <br>
        <input id="mat-amb-x" type="number" min="-1.0" max="1.0" step="0.1">
        <input id="mat-amb-y" type="number" min="-1.0" max="1.0" step="0.1">
        <input id="mat-amb-z" type="number" min="-1.0" max="1.0" step="0.1">
        <label>Material Ambient</label>
        <br>
        <input id="mat-dif-x" type="number" min="-1.0" max="1.0" step="0.1">
        <input id="mat-dif-y" type="number" min="-1.0" max="1.0" step="0.1">
        <input id="mat-dif-z" type="number" min="-1.0" max="1.0" step="0.1">
        <label>Material Diffuse</label>
        <br>
        <input id="mat-spec-x" type="number" min="-1.0" max="1.0" step="0.1">
        <input id="mat-spec-y" type="number" min="-1.0" max="1.0" step="0.1">
        <input id="mat-spec-z" type="number" min="-1.0" max="1.0" step="0.1">
        <label>Material Specular</label>
        <br>
        <input id="light-amb-x" type="number" min="-1.0" max="1.0" step="0.1">
        <input id="light-amb-y" type="number" min="-1.0" max="1.0" step="0.1">
        <input id="light-amb-z" type="number" min="-1.0" max="1.0" step="0.1">
        <label>Light Ambient</label>
        <br>
        <input id="light-dif-x" type="number" min="-1.0" max="1.0" step="0.1">
        <input id="light-dif-y" type="number" min="-1.0" max="1.0" step="0.1">
        <input id="light-dif-z" type="number" min="-1.0" max="1.0" step="0.1">
        <label>Light Diffuse</label>
        <br>
        <input id="light-spec-x" type="number" min="-1.0" max="1.0" step="0.1">
        <input id="light-spec-y" type="number" min="-1.0" max="1.0" step="0.1">
        <input id="light-spec-z" type="number" min="-1.0" max="1.0" step="0.1">
        <label>Light Specular</label>
    </div>

    <div id="objects" class="tabcontent">
        <h3>Objects</h3>
        <div>
            <input type="radio" id="new_cube" name="objects" value="CUBE" checked="checked">
            <label>Cube</label></br>
            <input type="radio" id="new_sphere" name="objects" value="SPHERE">
            <label>Sphere</label></br>
            <input type="radio" id="new_cylinder" name="objects" value="CYLINDER">
            <label>Cylinder</label></br>
            <input type="radio" id="new_torus" name="objects" value="TORUS">
            <label>Torus</label></br>
            <input type="radio" id="new_paraboloid" name="objects" value="PARABOLOID">
            <label>Paraboloid</label></br>

        </div>
    </div>
    <div class="switches">
        <footer>
            <label>Z-Buffer: </label> <label id="z-buffer-stats" class="led">OFF</label></br>
            <label>Culling: </label> <label id="culling-stats" class="led">OFF</label>
        </footer>
    </div>
</body>
<script type="text/javascript" src="gui.js"></script>

</html>